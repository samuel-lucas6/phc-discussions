phc-discussions - Re: [PHC] pre-hashed passwords?

Message-Id: <E1YY4ze-0001v8-GC@login01.fos.auckland.ac.nz>
Date: Wed, 18 Mar 2015 16:50:06 +1300
From: Peter Gutmann <pgut001@...auckland.ac.nz>
To: discussions@...sword-hashing.net
Subject: Re: [PHC] pre-hashed passwords?

Jean-Philippe Aumasson <jeanphilippe.aumasson@...il.comwrites:

>(After reading this nice post about passwords including null bytes:
>http://blog.ircmaxell.com/2015/03/security-issue-combining-bcrypt-with.html)

They've identified the wrong problem though, it's not the pre-hashing, it's
the fact that they're feeding binary data to an API that doesn't support it.
It's strcat()/strcmp()/strcpy() all over again.

>Has anyone already seen password hashes "pre-hashing" a password, to handle
>length limitations? 

Only HMAC, with its annoying duality where an input string larger than the
hash input size is hashed down before being used as a key, so you have two
different keys, a hash value and its preimage, valid to key each HMAC.

Peter.


