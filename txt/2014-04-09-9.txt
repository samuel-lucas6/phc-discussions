phc-discussions - Re: [PHC] Deriving multiple keys (was RE: Mechanical tests)


Message-ID: <9A043F3CF02CD34C8E74AC1594475C738A356A82@uxcn10-tdc06.UoA.auckland.ac.nz>
Date: Wed, 9 Apr 2014 13:57:45 +0000
From: Peter Gutmann <pgut001@...auckland.ac.nz>
To: "discussions@...sword-hashing.net" <discussions@...sword-hashing.net>
Subject: Re: [PHC] Deriving multiple keys (was RE: Mechanical tests)

Thomas Pornin <pornin@...et.orgwrites:

>In TLS (see section 6.3 of RFC 5246), the symmetric keys are derived from the
>"master secret" with a single PRF call:
>
  When keys and MAC keys are generated, the master secret is used as an
  entropy source.
>
  To generate the key material, compute
>
     key_block = PRF(SecurityParameters.master_secret,
                     "key expansion",
                     SecurityParameters.server_random +
                     SecurityParameters.client_random);

Oops, yeah, I was thinking of the general use of the label in the PRF, e.g.
the MAC/Finished-message "client finished" vs. "server finished", and then for
key expansion "master secret" vs. "key expansion", but you're right, the
keying material is from a single application of the PRF.

Peter.

