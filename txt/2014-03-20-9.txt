phc-discussions - Re: [PHC] Supporting AVX2/SSE2 or not with a single binary

Message-ID: <CAOLP8p4FX8ek16o4AaesP34ApgqtJKh2dTpz5o06qqzXJy-oWQ@mail.gmail.com>
Date: Thu, 20 Mar 2014 08:47:58 -0400
From: Bill Cox <waywardgeek@...il.com>
To: discussions@...sword-hashing.net
Subject: Re: [PHC] Supporting AVX2/SSE2 or not with a single binary

On Thu, Mar 20, 2014 at 8:04 AM, Darren J Moffat
<Darren.Moffat@...cle.comwrote:
This is something we have to deal with for the crypto libraries in Solaris.
We need a single set of binaries that run on systems with various different
CPU capabilities.
>
The linker/loader on Solaris has the ability to build a single ELF binary
with multiple implementations of the same functions based on the CPU
capabilities (we call them HWCAP) and the runtime loader automatically
selects the correct one based on which CPU you are running on.  For testing
and debug purposes you can tweak the list of CPU features that the runtime
loader selects on via the LD_HWCAP environment variable.
>
The assembler also automatically tags the output files with an indication of
which CPU features (instruction sets) it used.
>
I don't know if this functionality is available on other systems though.

Nice!  The best part about the Solaris solution is the application
authors don't have to figure it out on their own, which apparently is
harder than it should be.

Bill

