phc-discussions - PolyPassHash is broken

Message-ID: <1738575510.201261.1410684487302.open-xchange@oxuslxltgw06.lxa.perfora.net>
Date: Sun, 14 Sep 2014 03:48:07 -0500 (CDT)
From: Steve Thomas <steve@...tu.com>
To: "discussions@...sword-hashing.net" <discussions@...sword-hashing.net>
Subject: PolyPassHash is broken

I was just informed that I never mentioned this anywhere. Although I swear I
did:

Method 1
 * get partial hash from DB
 * find partial hash collision
 * crash/restart server
 * login

Method 1.5 (for large partial hash [like ~48 bits])
 * get partial hash from DB
 * find partial hash collision
 * try password
 * repeat steps until password is found
  - note you probably won't hit a password rate limit

Method 2
 * crash/restart server
 * quickly login several times
 * repeat steps until partial hash collision is found

If there are no partial hashes in the DB, then this is equivalent to HMAC with
secret key. Anyways this has a placeholder for a password hashing algo (ie the
winner of PHC). So even if it didn't have these problems then it could only be
mentioned in tandem with another entry.

Currently the hashing algorithm is "encrypt(SHA256(salt || password))"

