phc-discussions - Re: [PHC] yescrypt pre- and post-hashing

Message-ID: <CAOLP8p6dNf_rKYwQu+5xUbK5WKXWjn2sqGUbd12MDEg-ndZ9fw@mail.gmail.com>
Date: Sat, 31 Jan 2015 16:07:12 -0800
From: Bill Cox <waywardgeek@...il.com>
To: "discussions@...sword-hashing.net" <discussions@...sword-hashing.net>
Subject: Re: [PHC] yescrypt pre- and post-hashing

On Sat, Jan 31, 2015 at 3:59 PM, Solar Designer <solar@...nwall.comwrote:

This was believed to be just a peculiarity with no security impact.
Well, due to a recent tweet/reminder by Juliano Rizzo, I no longer think
so.  There was real security impact, even if in obscure cases.
>
Specifically, if a site upgrades from raw SHA-256 to e.g. scrypt hashes
(by re-hashing passwords as users log in), but does not securely wipe
all copies of the SHA-256 hashes from all places, then for the (few) 65+
char passwords those hashes can be used to log in to the service,
without the attacker ever having to crack the plaintext passwords.  This
was Juliano's original concern.
>
I came up with two more:
>

Wow... that's frigthening!  So, any leaked SHA-256 hash DB of y 65+
characterpassword would be accepted as valid by PBKDF2-SHA256.  That's a
rare case, but still a hole we should fill, IMO.

Thanks for coming up with this elegant solution to the problem.

Bill



