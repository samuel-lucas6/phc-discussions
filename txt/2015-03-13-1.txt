phc-discussions - Password hashing by itself is not enough

Message-ID: <CAOLP8p4N+u7QRpg8f-0BFuSVxaK0rYTnOgmi7w-bu80oDAQXXQ@mail.gmail.com>
Date: Thu, 12 Mar 2015 21:19:00 -0700
From: Bill Cox <waywardgeek@...il.com>
To: "discussions@...sword-hashing.net" <discussions@...sword-hashing.net>
Subject: Password hashing by itself is not enough

If the recent 10-million-combos.zip file that was posted with 10 million
user/password combinations is representative of user behavior, then a 5
million entry dictionary will contain over half of all user's passwords.
The first half of this file has over half of the passwords repeated in the
second half.

A solid upgrade to Scrypt will not be enough to secure the weaker half of
these passwords.  Should the PHC recommend that master secrets of some sort
be added to the key material, so that if the password database is stolen,
but not the master secret, no harm is done?  There is no parameter for
additional secret key material in the PHS function.  Would it make sense to
add one?  Secret key rotation is another issue.  Instead of hashing in the
secret key as additional key material, the secret key could be used to
encrypt the resulting password hash before storing it.  The official hash
result would be the encrypted value, but the master secret could be updated.

Just my latest noodling...

Bill



