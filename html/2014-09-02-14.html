<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style type="text/css">
body { font-size: 16px; }
.cal_brief { text-align: center; }
.cal_brief td:first-child { background: inherit; }
.cal_brief td { background: #ccc; width: 5ex; padding: 2px; }
.cal_big { text-align: center; padding: 0; margin: 0; }
.cal_big td { padding: 0 2px; }
.cal_mon { text-align: center; }
.cal_mon th { font-size: small; padding: 0; margin: 0; }
.cal_mon td { background: #ccc; width: 5ex; height: 1.5em;
	padding: 2px; text-align: right; }
.cal_mon td[colspan] { background: inherit; }
.cal_mon sup { color: #F0F0F0; text-align: left; float: left;
	margin-top: -2pt; font-weight: bold; }
.cal_mon a { text-align: right; margin-left: -4em; float: right; }
</style>

<title>phc-discussions - Re: [PHC] A review per day - Schvrch</title>


</head>

<BODY bgcolor="#E0E0E0" text="black" link="blue" alink="red" vlink="navy">



<TABLE bgcolor="white" width="100%" border="0" cellspacing="0" cellpadding="0">
<TR>
<TD width="39%">
<A HREF="http://lists.openwall.net">lists.openwall.net</A>
<TD width="1%" rowspan="3">&nbsp;
<TD width="60%" align="right" rowspan="3">
<A HREF="/">lists</A>&nbsp;
/&nbsp;
<A HREF="http://www.openwall.com/lists/announce/">announce</A>&nbsp;
<A HREF="http://www.openwall.com/lists/owl-users/">owl-users</A>&nbsp;
<A HREF="http://www.openwall.com/lists/owl-dev/">owl-dev</A>&nbsp;
<A HREF="http://www.openwall.com/lists/john-users/">john-users</A>&nbsp;
<A HREF="http://www.openwall.com/lists/john-dev/">john-dev</A>&nbsp;
<A HREF="http://www.openwall.com/lists/passwdqc-users/">passwdqc-users</A>&nbsp;
<A HREF="http://www.openwall.com/lists/yescrypt/">yescrypt</A>&nbsp;
<A HREF="http://www.openwall.com/lists/popa3d-users/">popa3d-users</A>&nbsp;
/&nbsp;
<A HREF="http://www.openwall.com/lists/oss-security/">oss-security</A>&nbsp;
<A HREF="http://www.openwall.com/lists/kernel-hardening/">kernel-hardening</A>&nbsp;
<A HREF="http://www.openwall.com/lists/musl/">musl</A>&nbsp;
<A HREF="http://www.openwall.com/lists/sabotage/">sabotage</A>&nbsp;
<A HREF="http://www.openwall.com/lists/tlsify/">tlsify</A>&nbsp;
<A HREF="http://www.openwall.com/lists/passwords/">passwords</A>&nbsp;
/&nbsp;
<A HREF="http://www.openwall.com/lists/crypt-dev/">crypt-dev</A>&nbsp;
<A HREF="http://www.openwall.com/lists/xvendor/">xvendor</A>&nbsp;
/&nbsp;
<A HREF="/bugtraq/">Bugtraq</A>&nbsp;
<A HREF="/full-disclosure/">Full-Disclosure</A>&nbsp;
<A HREF="/linux-kernel/">linux-kernel</A>&nbsp;
linux-<A HREF="/netdev/">netdev</A>&nbsp;
<A HREF="/linux-ext4/">linux-ext4</A>&nbsp;
<a href="/linux-hardening/">linux-hardening</a>&nbsp;
<a href="/linux-cve-announce/">linux-cve-announce</a>&nbsp;
<a href="/phc-discussions/">PHC</a>&nbsp;
<TR><TD>
<DIV><FONT SIZE="-2"><I>Open Source and information security mailing list archives</I></FONT></DIV>
<TR><TD>&nbsp;
</TABLE>

<TABLE bgcolor="#B4D0DC" width="100%" border="0" cellspacing="0" cellpadding="1">
<TR><TD>
<TABLE width="100%" border="0" cellspacing="0" cellpadding="2">
<TR><TD bgcolor="#ECF8FF">

<a href="https://hashsuite.openwall.net/android">
Hash Suite for Android: free password hash cracker in your pocket</a>


</TABLE>
</TABLE>


<a href="13">[&lt;prev]</a> <a href="15">[next&gt;]</a> <a href="13">[&lt;thread-prev]</a> <a href="15">[thread-next&gt;]</a> <a href=".">[day]</a> <a href="..">[month]</a> <a href="../..">[year]</a> <a href="../../..">[list]</a>
<pre style="white-space: pre-wrap">
Message-ID: &lt;5405D85D.7060001&#64;ciphershed.org&gt;
Date: Tue, 02 Sep 2014 10:46:53 -0400
From: Bill Cox &lt;waywardgeek&#64;...hershed.org&gt;
To: discussions&#64;...sword-hashing.net
Subject: Re: [PHC] A review per day - Schvrch

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 09/01/2014 11:25 PM, Rade Vuckovac wrote:
&gt; “The time cost has weak average memory*time because only one 2KiB
&gt; block is used while applying time cost.”
&gt; 
&gt; The time cost argument is as it should be, for the time algorithm
&gt; hardening only. The memory cost argument is independent on the time
&gt; cost argument and deals with memory hardening as it is expected.

This kind of statement is why Schvrch is difficult to fix.  Instead of
dismissing claims of weakness in your code, you should try and
understand why I think there is a weakness.  I am not the only poster
to point out flaws in Schvrch, and not a single concern was properly
addressed.  Simply claiming "The time cost argument is as it should
be," says nothing other than you think you are right and I am wrong.
I happen to believe the opposite in this case.

I posted a simple ASIC attack this morning that benefits by about a
factor of 200X in speed due to this weakness in Schvrch.  Let's talk
about this again when you understand this attack.

&gt; “No cryptographic primitives are applied, yet the mixing function
&gt; seems weak.”
&gt; 
&gt; Could not be more wrong. It was tried in the April discussion to
&gt; point some crypto analysis relevant to the Schvrch submission. One
&gt; of them is here <a href="http://dakhilalian.iut.ac.ir/pdff/C26.pdf" rel="nofollow">http://dakhilalian.iut.ac.ir/pdff/C26.pdf</a>

I pointed out real weaknesses in the mixing last spring, but you
continue to simply claim everyone else is wrong about the weaknesses
they're finding.

I posted another attack this morning that takes advantage of the
mixing weakness when m_cost == 0.  An attacker basically can ignore
the revolve rounds and determine if his guess is correct in constant
time, independent of t_cost.

&gt; “The evolve function at end just XORs states together and
&gt; complements them, leaving each as a simple linear combination of
&gt; the original. The author seems to have the mistaken impresion that
&gt; just XORing data over and over will mix it well.”
&gt; 
&gt; The very last program listing in Appendix (Schvrch submission) is a
&gt; random number generator which just “XORs states together and
&gt; complements them” and just do “XORing data over and over” and still
&gt; produces descent random streams.
&gt; 
&gt; However that does not mean it is secure.

I agree with this last statement.

&gt; If the submission paper is read / understood, then it will be clear
&gt; that the branching programing structure is a force behind “mix it
&gt; well”. The toy password hash scheme using the same security
&gt; paradigm as Schvrch may serve as an example.
&gt; 
&gt; Let n be a 512 bit string (salt and password combo). Treat n as a
&gt; positive integer. Apply (3n+1)/2 if n is odd else do n/2. The
&gt; result is new n. Repeat step above 256 times to the every new n
&gt; created to acquire a 256 bit parity string (recording 1 when new n
&gt; is odd and 0 when new n is even). Discard first 128 bits and use
&gt; the remaining 128 bits as the hash of n (arguably the tiniest
&gt; secure password hashing scheme around).

Very cool...

&gt; The paper has 2 lines of argumentation of why above is perfectly
&gt; secure:
&gt; 
&gt; 1.      While toy algorithm is sort of described that does not mean
&gt; that function description (in theoretical sense) is there. Without
&gt; knowledge of the input the toy function can be composed in 2^256
&gt; ways and the composition depends entirely on the input. There is
&gt; the case mentioned in random oracle theory when input complexity is
&gt; on the par with function description complexity. While this case
&gt; guaranties non-correlation between function instances (the
&gt; randomness) it is considered as impractical exercise (requires
&gt; gigantic table with records of fair coin flips).The toy algorithm
&gt; is practical when input (or output) is known. But with partial 
&gt; output (the toy case) the only way to match input is exhaustive
&gt; search because only complete input or output can define function
&gt; composition.
&gt; 
&gt; 2.      If there is possibility of finding some pattern /
&gt; correlation between instances when above algorithm is run, then
&gt; that possibility is a reduction of 2^256 complexity mentioned
&gt; above. In effect it will mean that branching can be reduced by
&gt; combination of the sequence and the looping algorithm structures.
&gt; That runs against structural programming theorem claiming branching
&gt; as a basic structure. Simply put, it is impossible to make program
&gt; for checking inputs of 3n+1 problem without using the branching
&gt; structure or some sort of exhaustive search.

Both of these statements may be true about your code, but it is still
dangerously insecure.  Defensive password hashing involves additional
criteria over cryptographic hash functions, such as insuring the
attacker must use as much memory for just as long as the user (or as
close to this as possible).

By the way, after reading this, I take back my statement that there's
no reason to believe Schvrch produces a "secure" hash.  It sounds like
you have done plenty in this area.  However, I see several angles for
attacking your code.  Obviously there is a disconnect between the
paper's proof of security and the reality of attacks against your code.

&gt; “I don't think there's much reason to spend a lot of time
&gt; discussing this version of Schvrch.”
&gt; 
&gt; The last statement and entire Mr Cox’s post is maybe fine as a
&gt; blog material where expressing opinions without substantiating them
&gt; is a norm. The frequency of that kind of posting, here, is not
&gt; helpful either.
&gt; 
&gt; Rade
&gt; 

I apologize for that.

I do make a lot of mistakes in my posts.  Part of it is I have no real
idea about how real people respond emotionally.  I did not want to
take time arguing with you when you've been quite clear about not
caring about the weaknesses we pointed out so far.  I figured that
anyone reading along would have noticed, and would have already
dropped Schvrch as a potential winner, and that just skipping the
review would be better for everyone.  I was wrong.

Until the weaknesses we pointed out already are addressed, there isn't
much point spending more time on Schvrch, IMO.  The simple fact that
you refuse to address the time*memory cost weakness (as you restated
above) should be enough to make this clear.  Your dismissal of the
hashing weakness in the t_cost loop is a similar situation.

Anyway, try and figure out what's wrong with Schvrch that allows for
so many simple attacks against it.  That's not my job.  I'm just
pointing out weaknesses I see.  If you don't want to address real
weaknesses, we should just move on.

Bill
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBAgAGBQJUBdhZAAoJEAcQZQdOpZUZ1DsP/3HO8F2r52GlO8taedx92ZFg
jjbx27NXqGWTqsj2j00m+TmQhK1uYILBPFCCLx2V9O6zOcb549RCrWh/dCZoK55a
kxlCzFv1Pxt9L+LNc5R6E0tOzukdikP8A7UZw8yfxOxhHm3tea3tG4r2NYF/FZk4
VeQR8g8AKFbyXo894zgtPu5aVmCh2hCQgscXUhc4Q2uYAnNpSjMiMpYqm1Y6xe3l
pPJieEs8B/uSqcH7zAjfxIayoldqzIT7GoqpbMK4d7gfYv6FMs5BKAUsyrJMuOnV
8c0cAba+bECP5b7rAxqPzWHEMzTtyZ7iHkPlxEbqBTokBI1oayTqzlbrCyFnJL4T
6YFN77mbRs344qByVMX0gdLEwR3jRO+ulgee5PX3PMrXuLGx6TEHHIXJhe5TnFtS
tuOW98iAWbOPrInJqOZdQrQxXEHDCq9QlWw1VtDlnf6q37VSsX8nHGHiA1x8HhMi
j9gK+ayMLVnJ0HuHXPFL6onylvOxtIA9zEBgcblFBrdG+CG5f4g9fHhGEr8skpBv
7SJuvTFxSahDGcttjY7oHzFYB9ZNgPrGYHsNkz/wqERnoVZKZoC7GU7cyHqDy6Ms
ryOQqO+cnWHun8bbmh15OzzlgPJp15uxDPRekuVSGxMlKpYejwhjHmzmPoXihji/
XvFILe2t0wJVnKPttf5s
=bVh8
-----END PGP SIGNATURE-----
</pre>
<p><a href="https://www.openwall.com/blists/">Powered by blists</a> - <a href="https://lists.openwall.net">more mailing lists</a>


<p>




</body>
</html>
