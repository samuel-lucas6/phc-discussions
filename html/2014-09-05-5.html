<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style type="text/css">
body { font-size: 16px; }
.cal_brief { text-align: center; }
.cal_brief td:first-child { background: inherit; }
.cal_brief td { background: #ccc; width: 5ex; padding: 2px; }
.cal_big { text-align: center; padding: 0; margin: 0; }
.cal_big td { padding: 0 2px; }
.cal_mon { text-align: center; }
.cal_mon th { font-size: small; padding: 0; margin: 0; }
.cal_mon td { background: #ccc; width: 5ex; height: 1.5em;
	padding: 2px; text-align: right; }
.cal_mon td[colspan] { background: inherit; }
.cal_mon sup { color: #F0F0F0; text-align: left; float: left;
	margin-top: -2pt; font-weight: bold; }
.cal_mon a { text-align: right; margin-left: -4em; float: right; }
</style>

<title>phc-discussions - Re: [PHC] A review per day - Makwa</title>


</head>

<BODY bgcolor="#E0E0E0" text="black" link="blue" alink="red" vlink="navy">



<TABLE bgcolor="white" width="100%" border="0" cellspacing="0" cellpadding="0">
<TR>
<TD width="39%">
<A HREF="http://lists.openwall.net">lists.openwall.net</A>
<TD width="1%" rowspan="3">&nbsp;
<TD width="60%" align="right" rowspan="3">
<A HREF="/">lists</A>&nbsp;
/&nbsp;
<A HREF="http://www.openwall.com/lists/announce/">announce</A>&nbsp;
<A HREF="http://www.openwall.com/lists/owl-users/">owl-users</A>&nbsp;
<A HREF="http://www.openwall.com/lists/owl-dev/">owl-dev</A>&nbsp;
<A HREF="http://www.openwall.com/lists/john-users/">john-users</A>&nbsp;
<A HREF="http://www.openwall.com/lists/john-dev/">john-dev</A>&nbsp;
<A HREF="http://www.openwall.com/lists/passwdqc-users/">passwdqc-users</A>&nbsp;
<A HREF="http://www.openwall.com/lists/yescrypt/">yescrypt</A>&nbsp;
<A HREF="http://www.openwall.com/lists/popa3d-users/">popa3d-users</A>&nbsp;
/&nbsp;
<A HREF="http://www.openwall.com/lists/oss-security/">oss-security</A>&nbsp;
<A HREF="http://www.openwall.com/lists/kernel-hardening/">kernel-hardening</A>&nbsp;
<A HREF="http://www.openwall.com/lists/musl/">musl</A>&nbsp;
<A HREF="http://www.openwall.com/lists/sabotage/">sabotage</A>&nbsp;
<A HREF="http://www.openwall.com/lists/tlsify/">tlsify</A>&nbsp;
<A HREF="http://www.openwall.com/lists/passwords/">passwords</A>&nbsp;
/&nbsp;
<A HREF="http://www.openwall.com/lists/crypt-dev/">crypt-dev</A>&nbsp;
<A HREF="http://www.openwall.com/lists/xvendor/">xvendor</A>&nbsp;
/&nbsp;
<A HREF="/bugtraq/">Bugtraq</A>&nbsp;
<A HREF="/full-disclosure/">Full-Disclosure</A>&nbsp;
<A HREF="/linux-kernel/">linux-kernel</A>&nbsp;
linux-<A HREF="/netdev/">netdev</A>&nbsp;
<A HREF="/linux-ext4/">linux-ext4</A>&nbsp;
<a href="/linux-hardening/">linux-hardening</a>&nbsp;
<a href="/linux-cve-announce/">linux-cve-announce</a>&nbsp;
<a href="/phc-discussions/">PHC</a>&nbsp;
<TR><TD>
<DIV><FONT SIZE="-2"><I>Open Source and information security mailing list archives</I></FONT></DIV>
<TR><TD>&nbsp;
</TABLE>

<TABLE bgcolor="#B4D0DC" width="100%" border="0" cellspacing="0" cellpadding="1">
<TR><TD>
<TABLE width="100%" border="0" cellspacing="0" cellpadding="2">
<TR><TD bgcolor="#ECF8FF">

<a href="https://hashsuite.openwall.net/android">
Hash Suite for Android: free password hash cracker in your pocket</a>


</TABLE>
</TABLE>


<a href="4">[&lt;prev]</a> <a href="6">[next&gt;]</a> <a href="4">[&lt;thread-prev]</a> <a href="6">[thread-next&gt;]</a> <a href=".">[day]</a> <a href="..">[month]</a> <a href="../..">[year]</a> <a href="../../..">[list]</a>
<pre style="white-space: pre-wrap">
Message-ID: &lt;540A25D5.4000306&#64;ciphershed.org&gt;
Date: Fri, 05 Sep 2014 17:06:29 -0400
From: Bill Cox &lt;waywardgeek&#64;...hershed.org&gt;
To: discussions&#64;...sword-hashing.net
Subject: Re: [PHC] A review per day - Makwa

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 09/05/2014 04:37 PM, Thomas Pornin wrote:
&gt; On Fri, Sep 05, 2014 at 01:40:45PM -0400, Bill Cox wrote:
&gt;&gt; The concern I am working through right now is trying to convince 
&gt;&gt; myself that Makwa will have good long cycle lengths when squaring
&gt;&gt; over and over, with effectively zero chance of getting a weak
&gt;&gt; cycle where finding the square root is many times easier.
&gt; 
&gt; If you can find small cycles then you can factor the modulus.
&gt; 
&gt; Indeed, choose a random x modulo N. Probability that x is a
&gt; quadratic residue modulo p is about 1/2. Probability that x is a
&gt; quadratic residue modulo q is also about 1/2. You can compute the
&gt; Jacobi symbol of x relatively to n, which will be 1 or -1; the
&gt; computation is easy (see the Wikipedia page:
&gt; <a href="http://en.wikipedia.org/wiki/Jacobi_symbol" rel="nofollow">http://en.wikipedia.org/wiki/Jacobi_symbol</a> ). We are here 
&gt; interested in values x such that the Jacobi symbol (x|n) = -1:
&gt; these are exactly the values which are a square modulo p but not
&gt; modulo q, or are a square modulo q but not modulo p. Probability of
&gt; a random x to be such a value is about 1/2, so finding one is
&gt; easy.
&gt; 
&gt; Suppose that such a x generates a small cycle. You can them
&gt; compute x^2, x^4, x^8... and so on, until you complete the cycle:
&gt; you end up with a value y which is such that y^2 = x^2 modulo N.
&gt; However, y is a quadratic residue, but x is not, so y != x; and
&gt; since (x|n) = -1, x cannot be equal to -y either. The consequence
&gt; is that y-x is a multiple of p and not q, or of q and not p. A
&gt; simple GCD computation between y-x and N reveals p or q, and N is
&gt; factored.
&gt; 
&gt; Therefore, if the probability of hitting a small cycle is not 
&gt; negligible, then you have an efficient factoring algorithm. Since 
&gt; integer factorization is hard for 2048-bit RSA-like moduli, small
&gt; cycles will not be reachable in practice, even if you try hard.
&gt; 
&gt; 
&gt; 
&gt; The notion of "safe prime" has been coined at various times, not
&gt; always for the same values. Usually, a prime p is called "safe" if
&gt; (p-1)/2 is also prime (note that it is not exactly the same meaning
&gt; as the one you use). That specific notion of safe prime was about
&gt; resistance to a factorization algorithm known as the "p-1 method",
&gt; which works for integers N = pq where p-1 is the product of only
&gt; small integers (this is called a "smooth integer"); in that sense,
&gt; selecting your prime factors (for RSA key pair generation) to be
&gt; "safe" (in that sense) guaranteed that the "p-1 method" was not
&gt; applicable.

I actually did mean that (p-1)/2 was prime when I said "safe" prime.

&gt; However, this was overkill. The probability that p-1 was
&gt; sufficiently smooth for a random prime p is extremely small, far
&gt; into the "utterly negligible" area. For a 1000-bit random integer
&gt; x, the average size of the largest prime factor of x is about 624
&gt; bits (this is linked to the Golomb-Dickman constant). I am too lazy
&gt; and rushed right now to compute the probability that, by generating
&gt; random 1000-bit integers, you hit a value whose largest prime
&gt; factor is less than 2^80, but it is negligible (less than 1 in
&gt; 2^200).
&gt; 
&gt; In the case of short cycles for Makwa, similar results hold. I
&gt; don't have time right now to quantify it (I'll try later this
&gt; week-end), but probability of finding a small cycle will be
&gt; negligible (which explains why it does not work in practice as a
&gt; factorization algorithm).
&gt; 
&gt; 
&gt; Yet another way to see it is the following: if you hit a short
&gt; cycle, short enough to be walked extensively, then you are breaking
&gt; Rabin encryption.
&gt; 
&gt; 
&gt; 
&gt; To sum up, trying to generate p and q factors with special
&gt; properties ot ensure a lack of short cycles is mostly wasted CPU,
&gt; since purely random primes will already ensure it with overwhelming
&gt; probability. You _can_ apply extra checks or insist on "safe prime"
&gt; for some notion of "safe", but the benefits will be only
&gt; psychological, not cryptographic: this won't improve security in
&gt; any tangible way, but it may help you sleep at night.
&gt; 
&gt; Since I personally don't have qualms with regards to short cycles,
&gt; I did not enforced any such "safe primes" in the modulus generation
&gt; tool provided with the Makwa reference code.
&gt; 
&gt; 
&gt; --Thomas Pornin

Thanks for that explanation!  I am nearly convinced that we can
increase the bit-strength against a cycle measuring attack to just a
few bits short of n's length.  However, given that attacking factoring
n with the simplest possible attack has strength sqrt(n), there's no
point.  Knowing that the cycle length being less than 2^1024 happens
with negligible probability is enough.

However, I did have a *lot* of fun with that analysis :-)

Bill
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBAgAGBQJUCiXRAAoJEAcQZQdOpZUZ2nkQAKPk0u/ap/0wLM3CR9Qcm7H3
OWOebxrxqYNY4TsDwQ2Ku9Ra2tEZGPCQLJxAAxnn11w0wSGWul5+428cl5xWgBgD
y5jx7LeCG8iDYzH16DrGY/ug7z2mQPFYgddl6BbQgW7jqDH3shLTd5mtNlBu1NTC
WE0rrnkGn6kk52GiQt5xNq6DvCTEFfO0lhzEuINKhbdGAFPnXshpmrlxtnobYCqa
qRzOJKcYk9kciwAXJpTRdny3wYPqDgQa4jcctPPh+db1d9kTIHt9LF7lGdA4cNsu
S7KU4UZB5S5E3SNnFA3d1DrQ6vWU4fWv2EL4ef+1jjvkqV96AESHNqspKvtMcFgf
mg4EA3LSN/FgUmI/zjI+Ut5o8NMRU8aZbb7XSKPGO20XkkOgpP+pAxhDQ1obz586
+J5aloxtkvnhn2kEPFZxpdoSIsUYX6KaVzwYJDYoiNQkJk2og2mf6UDoU5IMoe+x
QWDrPUX4Kzx0QwsynAt13DWtY7KD0md3h0l8dGUQ8hf9TxTdpzJLH1tT0JzS0CmA
Et9uPQ/WEgQNA17bdKL/eRaoLbnQB4vwgXp8duY4c9FsMn/gGmdhrzouPAcJd+To
tt+CxU/CnMjInrVBHrufRfh5gblBY0IrXl1+kG2CuEQwWCyQQhAG8KJjckWrJYIp
8bnbi41UZ5bERqEcdUe4
=cl6r
-----END PGP SIGNATURE-----
</pre>
<p><a href="https://www.openwall.com/blists/">Powered by blists</a> - <a href="https://lists.openwall.net">more mailing lists</a>


<p>




</body>
</html>
