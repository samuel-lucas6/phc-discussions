<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style type="text/css">
body { font-size: 16px; }
.cal_brief { text-align: center; }
.cal_brief td:first-child { background: inherit; }
.cal_brief td { background: #ccc; width: 5ex; padding: 2px; }
.cal_big { text-align: center; padding: 0; margin: 0; }
.cal_big td { padding: 0 2px; }
.cal_mon { text-align: center; }
.cal_mon th { font-size: small; padding: 0; margin: 0; }
.cal_mon td { background: #ccc; width: 5ex; height: 1.5em;
	padding: 2px; text-align: right; }
.cal_mon td[colspan] { background: inherit; }
.cal_mon sup { color: #F0F0F0; text-align: left; float: left;
	margin-top: -2pt; font-weight: bold; }
.cal_mon a { text-align: right; margin-left: -4em; float: right; }
</style>

<title>phc-discussions - Re: [PHC] GPU benchmarks: Lyra2+yescrypt</title>


</head>

<BODY bgcolor="#E0E0E0" text="black" link="blue" alink="red" vlink="navy">



<TABLE bgcolor="white" width="100%" border="0" cellspacing="0" cellpadding="0">
<TR>
<TD width="39%">
<A HREF="http://lists.openwall.net">lists.openwall.net</A>
<TD width="1%" rowspan="3">&nbsp;
<TD width="60%" align="right" rowspan="3">
<A HREF="/">lists</A>&nbsp;
/&nbsp;
<A HREF="http://www.openwall.com/lists/announce/">announce</A>&nbsp;
<A HREF="http://www.openwall.com/lists/owl-users/">owl-users</A>&nbsp;
<A HREF="http://www.openwall.com/lists/owl-dev/">owl-dev</A>&nbsp;
<A HREF="http://www.openwall.com/lists/john-users/">john-users</A>&nbsp;
<A HREF="http://www.openwall.com/lists/john-dev/">john-dev</A>&nbsp;
<A HREF="http://www.openwall.com/lists/passwdqc-users/">passwdqc-users</A>&nbsp;
<A HREF="http://www.openwall.com/lists/yescrypt/">yescrypt</A>&nbsp;
<A HREF="http://www.openwall.com/lists/popa3d-users/">popa3d-users</A>&nbsp;
/&nbsp;
<A HREF="http://www.openwall.com/lists/oss-security/">oss-security</A>&nbsp;
<A HREF="http://www.openwall.com/lists/kernel-hardening/">kernel-hardening</A>&nbsp;
<A HREF="http://www.openwall.com/lists/musl/">musl</A>&nbsp;
<A HREF="http://www.openwall.com/lists/sabotage/">sabotage</A>&nbsp;
<A HREF="http://www.openwall.com/lists/tlsify/">tlsify</A>&nbsp;
<A HREF="http://www.openwall.com/lists/passwords/">passwords</A>&nbsp;
/&nbsp;
<A HREF="http://www.openwall.com/lists/crypt-dev/">crypt-dev</A>&nbsp;
<A HREF="http://www.openwall.com/lists/xvendor/">xvendor</A>&nbsp;
/&nbsp;
<A HREF="/bugtraq/">Bugtraq</A>&nbsp;
<A HREF="/full-disclosure/">Full-Disclosure</A>&nbsp;
<A HREF="/linux-kernel/">linux-kernel</A>&nbsp;
linux-<A HREF="/netdev/">netdev</A>&nbsp;
<A HREF="/linux-ext4/">linux-ext4</A>&nbsp;
<a href="/linux-hardening/">linux-hardening</a>&nbsp;
<a href="/linux-cve-announce/">linux-cve-announce</a>&nbsp;
<a href="/phc-discussions/">PHC</a>&nbsp;
<TR><TD>
<DIV><FONT SIZE="-2"><I>Open Source and information security mailing list archives</I></FONT></DIV>
<TR><TD>&nbsp;
</TABLE>

<TABLE bgcolor="#B4D0DC" width="100%" border="0" cellspacing="0" cellpadding="1">
<TR><TD>
<TABLE width="100%" border="0" cellspacing="0" cellpadding="2">
<TR><TD bgcolor="#ECF8FF">

<a href="https://hashsuite.openwall.net/android">
Hash Suite for Android: free password hash cracker in your pocket</a>


</TABLE>
</TABLE>


<a href="1">[&lt;prev]</a> <a href="3">[next&gt;]</a> <a href="4">[thread-next&gt;]</a> <a href=".">[day]</a> <a href="..">[month]</a> <a href="../..">[year]</a> <a href="../../..">[list]</a>
<pre style="white-space: pre-wrap">
Message-ID: &lt;554D2632.5090501&#64;larc.usp.br&gt;
Date: Fri, 08 May 2015 18:10:10 -0300
From: Marcos Simplicio &lt;mjunior&#64;...c.usp.br&gt;
To: discussions&#64;...sword-hashing.net
Subject: Re: [PHC] GPU benchmarks: Lyra2+yescrypt

&gt; -------- Forwarded Message --------
&gt; Assunto:     Re: [PHC] GPU benchmarks: Lyra2+yescrypt (was: Another PHC
&gt; candidates "mechanical" tests (ROUND2))
&gt; Data:     Thu, 7 May 2015 20:32:47 +0300
&gt; De:     Solar Designer &lt;solar&#64;...nwall.com&gt;
&gt; Responder a:     discussions&#64;...sword-hashing.net
&gt; Para:     discussions&#64;...sword-hashing.net
&gt; 
&gt; 
&gt; 
&gt; Hi Marcos,
&gt; 
&gt; Thank you for working on this!  It's much appreciated.
&gt; 
&gt; I intend to take a closer look and provide a response to the specific
&gt; points you raised later.  Meanwhile:
&gt; 
&gt; I find the testing methodology weird and wrong.  You're reporting
&gt; microseconds.  You should be reporting hashes per second rates 

OK, hashes/s is indeed a better metric for reporting this. Alone, this
should not change the ratios shown in the 3rd column, though, so I do
not agree that the end result is actually wrong. I agree that further
tests can be made and *added* to the analysis, though, and that is a
good thing (see below).

Anyhow, the code was made available so anyone can improve the tests for
different platforms (note: please try getting the code from the root
folder, "<a href="https://github.com/leocalm/Lyra/" rel="nofollow">https://github.com/leocalm/Lyra/</a>", not from the sub-folder I
sent earlier). We will also include our execution scripts there as soon
as we clean them up.


&gt; for full
&gt; device load, for both CPU and GPU.

For the CPU, I guess you are proposing we do something similar to what
Milan did in Test9, right? If so, that sounds reasonable.

Now, for the GPU, we have to disagree: (see
<a href="http://docs.nvidia.com/cuda/cuda-c-best-practices-guide/index.html#occupancy" rel="nofollow">http://docs.nvidia.com/cuda/cuda-c-best-practices-guide/index.html#occupancy</a>):

"Higher occupancy does not always equate to higher performance-there is
a point above which additional occupancy does not improve performance.
However, low occupancy always interferes with the ability to hide memory
latency, resulting in performance degradation."

Since we were looking for the best throughput, our scripts tried many
different occupancies until the optimal point was found, just like we
did for plotting "Figure 20" in Lyra2's Reference Guide. Indeed, 8
threads per warp gives lower latency (hence, higher throughput) than the
usual 32 threads per warp, for both algorithms, so the former is optimal
for the attacker.

&gt; In a similar spirit, I think we should lock p=1 for these tests, and add
&gt; the maximum amount of parallelism externally - much like it'd happen on
&gt; an authentication server or in an attack.  So e.g. on a quad-core Intel
&gt; CPU with HT, we should run 8 threads externally to both yescrypt and
&gt; Lyra2, both at p=1. 

That is a reasonable test.

&gt; And keep the memory (de)allocation out of the loop,
&gt; if we can - or maybe report both kinds of benchmarks (with this overhead
&gt; included or excluded, as it can be either depending on how well a given
&gt; software integration or server deployment has been performed).

We will start with (de)allocations inside the loop, since that seems to
have better correspondence with a higher memory usage scenario (and
takes less effort for now :) )

&gt; 
&gt; For yescrypt t=0, 2 MB, you report latency from 1750 us to 2700 us for
&gt; p=1 to p=4.  However, I know that e.g. on i7-4770K, it performs 3400
&gt; hashes/s (without use of AVX2) at 2 MB per thread.  Luckily, for the
&gt; purpose of this comparison, it's around 3400 for 4 or 8 threads -
&gt; doesn't matter.  (I think this is in part due to 2 MB being exactly the
&gt; L3 cache size per core, as well as due to yescrypt including slightly
&gt; excessive parallelism when run with 128-bit SIMD.)  That's for 8 MB or
&gt; 16 MB total.  1750 us could suggest a throughput of only 570 per second,
&gt; which is 6 times lower than actual (and IIUC yours is for 2 MB total,
&gt; vs. 8 MB or 16 MB total for my 3400 figure).  But things don't really
&gt; work like that, which highlights the problem with the methodology.

We will try to use the same approach Milan did in his benchmarks to have
comparable results.

For a sanity check, though: Figure 10 in Milan's benchmarks shows a
throughput of ~1100 h/s for mcost = 1 MiB, tcost = min (so, yescrypt's
T=0) and parallel_processes = 1, which is much closer to what our
latency measurements suggest (~750 h/s) than to your numbers. My best
guess is that most of the difference comes from the different platforms
(hardware, OS, etc.),not necessarily from methodology. For example,
considering only processor speed, ours is 2.2 GHz, Milan's is 2.1 GHz,
and i7-4770K is 3.5 GHz.

BR,

Marcos.
</pre>
<p><a href="https://www.openwall.com/blists/">Powered by blists</a> - <a href="https://lists.openwall.net">more mailing lists</a>


<p>




</body>
</html>
