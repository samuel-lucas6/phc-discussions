<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style type="text/css">
body { font-size: 16px; }
.cal_brief { text-align: center; }
.cal_brief td:first-child { background: inherit; }
.cal_brief td { background: #ccc; width: 5ex; padding: 2px; }
.cal_big { text-align: center; padding: 0; margin: 0; }
.cal_big td { padding: 0 2px; }
.cal_mon { text-align: center; }
.cal_mon th { font-size: small; padding: 0; margin: 0; }
.cal_mon td { background: #ccc; width: 5ex; height: 1.5em;
	padding: 2px; text-align: right; }
.cal_mon td[colspan] { background: inherit; }
.cal_mon sup { color: #F0F0F0; text-align: left; float: left;
	margin-top: -2pt; font-weight: bold; }
.cal_mon a { text-align: right; margin-left: -4em; float: right; }
</style>

<title>phc-discussions - Re: [PHC] Interest in specification of modular crypt format</title>


</head>

<BODY bgcolor="#E0E0E0" text="black" link="blue" alink="red" vlink="navy">



<TABLE bgcolor="white" width="100%" border="0" cellspacing="0" cellpadding="0">
<TR>
<TD width="39%">
<A HREF="http://lists.openwall.net">lists.openwall.net</A>
<TD width="1%" rowspan="3">&nbsp;
<TD width="60%" align="right" rowspan="3">
<A HREF="/">lists</A>&nbsp;
/&nbsp;
<A HREF="http://www.openwall.com/lists/announce/">announce</A>&nbsp;
<A HREF="http://www.openwall.com/lists/owl-users/">owl-users</A>&nbsp;
<A HREF="http://www.openwall.com/lists/owl-dev/">owl-dev</A>&nbsp;
<A HREF="http://www.openwall.com/lists/john-users/">john-users</A>&nbsp;
<A HREF="http://www.openwall.com/lists/john-dev/">john-dev</A>&nbsp;
<A HREF="http://www.openwall.com/lists/passwdqc-users/">passwdqc-users</A>&nbsp;
<A HREF="http://www.openwall.com/lists/yescrypt/">yescrypt</A>&nbsp;
<A HREF="http://www.openwall.com/lists/popa3d-users/">popa3d-users</A>&nbsp;
/&nbsp;
<A HREF="http://www.openwall.com/lists/oss-security/">oss-security</A>&nbsp;
<A HREF="http://www.openwall.com/lists/kernel-hardening/">kernel-hardening</A>&nbsp;
<A HREF="http://www.openwall.com/lists/musl/">musl</A>&nbsp;
<A HREF="http://www.openwall.com/lists/sabotage/">sabotage</A>&nbsp;
<A HREF="http://www.openwall.com/lists/tlsify/">tlsify</A>&nbsp;
<A HREF="http://www.openwall.com/lists/passwords/">passwords</A>&nbsp;
/&nbsp;
<A HREF="http://www.openwall.com/lists/crypt-dev/">crypt-dev</A>&nbsp;
<A HREF="http://www.openwall.com/lists/xvendor/">xvendor</A>&nbsp;
/&nbsp;
<A HREF="/bugtraq/">Bugtraq</A>&nbsp;
<A HREF="/full-disclosure/">Full-Disclosure</A>&nbsp;
<A HREF="/linux-kernel/">linux-kernel</A>&nbsp;
linux-<A HREF="/netdev/">netdev</A>&nbsp;
<A HREF="/linux-ext4/">linux-ext4</A>&nbsp;
<a href="/linux-hardening/">linux-hardening</a>&nbsp;
<a href="/linux-cve-announce/">linux-cve-announce</a>&nbsp;
<a href="/phc-discussions/">PHC</a>&nbsp;
<TR><TD>
<DIV><FONT SIZE="-2"><I>Open Source and information security mailing list archives</I></FONT></DIV>
<TR><TD>&nbsp;
</TABLE>

<TABLE bgcolor="#B4D0DC" width="100%" border="0" cellspacing="0" cellpadding="1">
<TR><TD>
<TABLE width="100%" border="0" cellspacing="0" cellpadding="2">
<TR><TD bgcolor="#ECF8FF">

<a href="https://hashsuite.openwall.net/android">
Hash Suite for Android: free password hash cracker in your pocket</a>


</TABLE>
</TABLE>


<a href="3">[&lt;prev]</a> <a href="5">[next&gt;]</a> <a href="3">[&lt;thread-prev]</a> <a href="6">[thread-next&gt;]</a> <a href=".">[day]</a> <a href="..">[month]</a> <a href="../..">[year]</a> <a href="../../..">[list]</a>
<pre style="white-space: pre-wrap">
Message-ID: &lt;CAAyV7nF_u72Aq1GhfRHvEnK-82DeSWe2T63P3svhR3chTASgew&#64;mail.gmail.com&gt;
Date: Sun, 27 Sep 2015 16:46:48 -0400
From: Anthony Ferrara &lt;ircmaxell&#64;...il.com&gt;
To: discussions&#64;...sword-hashing.net
Subject: Re: [PHC] Interest in specification of modular crypt format

Alexander,

On Sep 27, 2015 2:52 PM, "Solar Designer" &lt;solar&#64;...nwall.com&gt; wrote:
&gt;
&gt; Hi Anthony,
&gt;
&gt; Thank you for sharing your opinion.
&gt;
&gt; On Sun, Sep 27, 2015 at 09:40:50AM -0400, Anthony Ferrara wrote:
&gt; &gt; Please, can the encoding be kept human-readable?
&gt;
&gt; Maybe.  At least I've counted your vote. ;-)
&gt;
&gt; &gt; Going with one-off encodings does look elegant,
&gt;
&gt; What do you mean by one-off here?  That no other hashing scheme would
&gt; use the same encoding?  Ideally, we'd come up with an encoding, whether
&gt; human-readable or not, that multiple schemes would adopt.

Unless I misread, it seemed like there was a suggestion to change the
encoding per parameter. Parameters that have no valid 0 would be encoded
where the first representable value is 1.

If that was not the case, then never mind.

&gt; &gt; but it makes the implementation significantly more error prone.
&gt;
&gt; Does it?  Maybe that depends on the kind of errors you care about vs.
&gt; disregard.  In my proposed numeric encoding, I am focusing on having
&gt; implementation errors detectable in normal encoding/decoding of valid
&gt; inputs, or being impossible (e.g., can't overflow an int, can't encode
&gt; the same parameter more than once).  With a human-readable encoding like
&gt; Thomas', there are less critical potential errors that, on the other
&gt; hand, would tend to go undetected for long.  Even if the spec has lots
&gt; of MUST's and MUST NOT's, implementations will end up parsing strings
&gt; like p=1,t=2,p=3 (is it p=1 or p=3, then? parsing will vary between
&gt; implementations, and only a handful will actually reject such strings).

I would say that this is simply an error and the spec should define it as
such. A few test vectors for the error case would be good there.

&gt; &gt; People are even confused by the fact that the salt-boundary in bcrypt
&gt; &gt; occurs mid-character (leading to only 4 possible character values for
&gt; &gt; the last salt character).
&gt;
&gt; Yes, and I have no good solution for that one (short of the workaround
&gt; of using multiples of 6 for bit sizes of salts and hashes, or for
&gt; salts+hashes combined as Alexander Cherepanov mentioned to me off-list).

For the record, I am not saying that problem should be "solved". Just to
keep in mind that making things more clever and more efficient on packing
is fine, but it may make the generation of the sale less intuitive.
Something to keep in mind.

&gt; So it's a problem common for compact and verbose encodings, and not a
&gt; reason to choose one over the other.
&gt;
&gt; &gt; Instead, can we focus on readability?
&gt;
&gt; I'd be happy to, but it comes with drawbacks.  Such as:
&gt;
&gt; &gt; For parameters that have well
&gt; &gt; defined defaults, simply don't require that parameter to be specified.
&gt;
&gt; This means the encoding is not deterministic.  A parameter can be
&gt; omitted, or it can be explicitly included with its default value.
&gt;
&gt; That's bad.  There's value in having canonical encodings, and in there
&gt; being only one canonical encoding for a given set of parameters, salt,
&gt; and hash.
&gt;
&gt; If we change "don't require that parameter to be specified" to "require
&gt; that parameter not to be specified", that's better, but then many
&gt; parsers will not actually enforce this rule.  Maybe that's a minor
&gt; enough issue to accept it.  (The issue with multiple specification of a
&gt; parameter is worse.)

Fair enough. Though I don't know which I would rather weight for. My
instinct is to make the implementation more difficult to make the lives of
the users easier. But that is not a strict tradeoff. More of something to
keep in mind as a rule of thumb.

&gt; &gt; For those that don't have well defined defaults, then always require
&gt; &gt; them. Yes, it is a little bit more parsing overhead on the crypt()
&gt; &gt; implementation, but it greatly reduces the overhead on the calling
&gt; &gt; code. Especially for those building wrappers (which happens all the
&gt; &gt; time).
&gt; &gt;
&gt; &gt; I do like the approach of specifically identifying parameter that was
&gt; &gt; brought up in the other thread. Something along the lines for scrypt:
&gt; &gt;
&gt; &gt;     $7$n=14;r=8;p=1$ALotOfSalt$Hash
&gt; &gt;
&gt; &gt; But since p=1 could reasonably be default, the following is identical:
&gt; &gt;
&gt; &gt;     $7$n=14;r=8$ALotOfSalt$Hash
&gt; &gt;
&gt; &gt; Whether a parameter is power-of-2 or base 10 would depend on the
&gt; &gt; algorithm. Also, please don't define the parameter order as rigid.
&gt; &gt; It's simple enough to implement arbitrary order, so why put arbitrary
&gt; &gt; restrictions?
&gt;
&gt; Deterministic canonical encoding.  Side-stepping the issue of multiple
&gt; specification of a parameter (as long as the parser actually rejects
&gt; encodings with parameters appearing in unexpected order).
&gt;
&gt; &gt; So my overall suggestion is make it easier on the developer using the
&gt; &gt; API, rather than the one writing it. After all, there are going to be
&gt; &gt; FAR more people writing a salt string then there will be writing the
&gt; &gt; backend implementation. Optimize for the greater use-case...
&gt;
&gt; This makes sense to me.  We will need to provide an API for generating
&gt; salt strings (or "setting strings", as they're called for bsdicrypt and
&gt; on) anyway, but you have a valid point that, especially if the encoding
&gt; is simple for an application developer to understand, many developers
&gt; will be generating such strings on their own.
&gt;
&gt; For PHP and such, I think this pretty much implies the encoding will
&gt; also need to use RFC Base64.  Then it's just sprintf of some decimal
&gt; numbers and some base64()'s.  So my point remains that Thomas' proposed
&gt; encoding is neither here nor there.

Completely fair. I am less concerned around the encoding of the salt than
the encoding and specification of the parameters. If a high level api is
provided for generating the salt, then awesome. That helps a lot. Though I
would still suggest keeping it readable.

There are a ton of tradeoffs involved, and I appreciate what this team is
doing. Whatever the end result is, it will be adopted.

So thanks!

Anthony

&gt; Thanks again,
&gt;
&gt; Alexander

<span style="font-family: times;"><strong>Content of type "</strong>text/html<strong>" skipped</strong></span>
</pre>
<p><a href="https://www.openwall.com/blists/">Powered by blists</a> - <a href="https://lists.openwall.net">more mailing lists</a>


<p>




</body>
</html>
