<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style type="text/css">
body { font-size: 16px; }
.cal_brief { text-align: center; }
.cal_brief td:first-child { background: inherit; }
.cal_brief td { background: #ccc; width: 5ex; padding: 2px; }
.cal_big { text-align: center; padding: 0; margin: 0; }
.cal_big td { padding: 0 2px; }
.cal_mon { text-align: center; }
.cal_mon th { font-size: small; padding: 0; margin: 0; }
.cal_mon td { background: #ccc; width: 5ex; height: 1.5em;
	padding: 2px; text-align: right; }
.cal_mon td[colspan] { background: inherit; }
.cal_mon sup { color: #F0F0F0; text-align: left; float: left;
	margin-top: -2pt; font-weight: bold; }
.cal_mon a { text-align: right; margin-left: -4em; float: right; }
</style>

<title>phc-discussions - Re: [PHC] Re: NoelKDF ready for submission</title>


</head>

<BODY bgcolor="#E0E0E0" text="black" link="blue" alink="red" vlink="navy">



<TABLE bgcolor="white" width="100%" border="0" cellspacing="0" cellpadding="0">
<TR>
<TD width="39%">
<A HREF="http://lists.openwall.net">lists.openwall.net</A>
<TD width="1%" rowspan="3">&nbsp;
<TD width="60%" align="right" rowspan="3">
<A HREF="/">lists</A>&nbsp;
/&nbsp;
<A HREF="http://www.openwall.com/lists/announce/">announce</A>&nbsp;
<A HREF="http://www.openwall.com/lists/owl-users/">owl-users</A>&nbsp;
<A HREF="http://www.openwall.com/lists/owl-dev/">owl-dev</A>&nbsp;
<A HREF="http://www.openwall.com/lists/john-users/">john-users</A>&nbsp;
<A HREF="http://www.openwall.com/lists/john-dev/">john-dev</A>&nbsp;
<A HREF="http://www.openwall.com/lists/passwdqc-users/">passwdqc-users</A>&nbsp;
<A HREF="http://www.openwall.com/lists/yescrypt/">yescrypt</A>&nbsp;
<A HREF="http://www.openwall.com/lists/popa3d-users/">popa3d-users</A>&nbsp;
/&nbsp;
<A HREF="http://www.openwall.com/lists/oss-security/">oss-security</A>&nbsp;
<A HREF="http://www.openwall.com/lists/kernel-hardening/">kernel-hardening</A>&nbsp;
<A HREF="http://www.openwall.com/lists/musl/">musl</A>&nbsp;
<A HREF="http://www.openwall.com/lists/sabotage/">sabotage</A>&nbsp;
<A HREF="http://www.openwall.com/lists/tlsify/">tlsify</A>&nbsp;
<A HREF="http://www.openwall.com/lists/passwords/">passwords</A>&nbsp;
/&nbsp;
<A HREF="http://www.openwall.com/lists/crypt-dev/">crypt-dev</A>&nbsp;
<A HREF="http://www.openwall.com/lists/xvendor/">xvendor</A>&nbsp;
/&nbsp;
<A HREF="/bugtraq/">Bugtraq</A>&nbsp;
<A HREF="/full-disclosure/">Full-Disclosure</A>&nbsp;
<A HREF="/linux-kernel/">linux-kernel</A>&nbsp;
linux-<A HREF="/netdev/">netdev</A>&nbsp;
<A HREF="/linux-ext4/">linux-ext4</A>&nbsp;
<a href="/linux-hardening/">linux-hardening</a>&nbsp;
<a href="/linux-cve-announce/">linux-cve-announce</a>&nbsp;
<a href="/phc-discussions/">PHC</a>&nbsp;
<TR><TD>
<DIV><FONT SIZE="-2"><I>Open Source and information security mailing list archives</I></FONT></DIV>
<TR><TD>&nbsp;
</TABLE>

<TABLE bgcolor="#B4D0DC" width="100%" border="0" cellspacing="0" cellpadding="1">
<TR><TD>
<TABLE width="100%" border="0" cellspacing="0" cellpadding="2">
<TR><TD bgcolor="#ECF8FF">

<a href="https://hashsuite.openwall.net/android">
Hash Suite for Android: free password hash cracker in your pocket</a>


</TABLE>
</TABLE>


<a href="11">[&lt;prev]</a> <a href="../../../2014/02/08/1">[next&gt;]</a> <a href="10">[&lt;thread-prev]</a> <a href="../../../2014/02/08/1">[thread-next&gt;]</a> <a href=".">[day]</a> <a href="..">[month]</a> <a href="../..">[year]</a> <a href="../../..">[list]</a>
<pre style="white-space: pre-wrap">
Message-ID: &lt;CAOLP8p7+=J+vrzLRF5hnJcJjnKc=V2nWonE-BBX7om+C2To+AA&#64;mail.gmail.com&gt;
Date: Fri, 7 Feb 2014 17:32:45 -0500
From: Bill Cox &lt;waywardgeek&#64;...il.com&gt;
To: discussions&#64;...sword-hashing.net
Subject: Re: [PHC] Re: NoelKDF ready for submission

On Fri, Feb 7, 2014 at 1:35 PM, Steve Thomas &lt;steve&#64;...tu.com&gt; wrote:
&gt;&gt; On February 6, 2014 at 11:38 PM Bill Cox &lt;waywardgeek&#64;...il.com&gt; wrote:
&gt;&gt;
&gt;&gt; On Thu, Feb 6, 2014 at 10:48 PM, Steve Thomas &lt;steve&#64;...tu.com&gt; wrote:
&gt;&gt; &gt; hash = PBKDF2_SHA256(password, salt, 1, hashSize)
&gt;&gt; &gt; ...
&gt;&gt; &gt; return hash ^ lastHashSizeBytesOfMem
&gt;&gt; &gt; Make a guess and xor "PBKDF2_SHA256(password, salt, 1, hashSize)" to the
&gt;&gt; &gt; hash
&gt;&gt; &gt; you are trying to crack. You now have the assumed last bytes of mem.
&gt;&gt;
&gt;&gt; Holy cow! These hashed bits are not meant to be cryptographically
&gt;&gt; indistinguishable from random, so with a correct password guess, you
&gt;&gt; might be able to check if it's correct just by analyzing the hashed
&gt;&gt; memory bits.
&gt;&gt;
&gt;&gt; I added another PBKDF2-SHA256 as a post-process to the XORed hash.
&gt;&gt; This should defeat such attacks, shouldn't it?
&gt;
&gt; Yes this is why I said to make xorIntoHash a cryptographic hash function.
&gt; Doing
&gt; it after xorIntoHash is fine. You just need to prevent leaking data about
&gt; mem.

Got it.

&gt;&gt; Wow. So, modulo 4, the multiply goes away and you developed an attack
&gt;&gt; from there that can be highly parallel and memory efficient. Nice.
&gt;&gt;
&gt;&gt; With an additional application of H at the end of the loop to the hash
&gt;&gt; value, this attack becomes unfeasible, doesn't it?
&gt;
&gt; Yes. I was going to also suggest doing the following, but I don't see how
&gt; doing
&gt; the first half modulo 4  (or some other) would benefit  the attacker now.
&gt;
&gt; value = ROTATE_LEFT(value*(mem[prevAddr + i] | 3) + mem[fromAddr + i], 1);

It's still a little creepy having that modulo 4 math eliminating the
multiply.  Gary sent a quick response to my initial NoelKDF hash
function, where he thought the OR was an AND, and his complaint that
an attacker could skip the multiply wasn't as far off as I'd thought.
If anyone can think of a reason to worry about it, I'll put in the
rotate, or something like it.  I do want to keep the number of
non-multiply operations to a minimum.

&gt;&gt; Is there any
&gt;&gt; reason to apply H to more of the data than the last hashlen bits of
&gt;&gt; each thread's memory, or is a post-process application of H to the
&gt;&gt; existing XOR-hash just as good? This is what my revised version
&gt;&gt; currently does, but if there's a reason to change this, I will.
&gt;
&gt; I originally said to do more than just hashlen bits, but I don't know if
&gt; that's
&gt; really necessary.

I ran 1,000,000 runs of NoelKDF with 1MiB memory and the last 32 bits
had 113 collisions, right in the middle of the expected range.  That's
in addtion to the dieharder tests.

Bill
</pre>
<p><a href="https://www.openwall.com/blists/">Powered by blists</a> - <a href="https://lists.openwall.net">more mailing lists</a>


<p>




</body>
</html>
