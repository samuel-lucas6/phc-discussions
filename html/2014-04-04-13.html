<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style type="text/css">
body { font-size: 16px; }
.cal_brief { text-align: center; }
.cal_brief td:first-child { background: inherit; }
.cal_brief td { background: #ccc; width: 5ex; padding: 2px; }
.cal_big { text-align: center; padding: 0; margin: 0; }
.cal_big td { padding: 0 2px; }
.cal_mon { text-align: center; }
.cal_mon th { font-size: small; padding: 0; margin: 0; }
.cal_mon td { background: #ccc; width: 5ex; height: 1.5em;
	padding: 2px; text-align: right; }
.cal_mon td[colspan] { background: inherit; }
.cal_mon sup { color: #F0F0F0; text-align: left; float: left;
	margin-top: -2pt; font-weight: bold; }
.cal_mon a { text-align: right; margin-left: -4em; float: right; }
</style>

<title>phc-discussions - Re: [PHC] Re: EARWORM review</title>


</head>

<BODY bgcolor="#E0E0E0" text="black" link="blue" alink="red" vlink="navy">



<TABLE bgcolor="white" width="100%" border="0" cellspacing="0" cellpadding="0">
<TR>
<TD width="39%">
<A HREF="http://lists.openwall.net">lists.openwall.net</A>
<TD width="1%" rowspan="3">&nbsp;
<TD width="60%" align="right" rowspan="3">
<A HREF="/">lists</A>&nbsp;
/&nbsp;
<A HREF="http://www.openwall.com/lists/announce/">announce</A>&nbsp;
<A HREF="http://www.openwall.com/lists/owl-users/">owl-users</A>&nbsp;
<A HREF="http://www.openwall.com/lists/owl-dev/">owl-dev</A>&nbsp;
<A HREF="http://www.openwall.com/lists/john-users/">john-users</A>&nbsp;
<A HREF="http://www.openwall.com/lists/john-dev/">john-dev</A>&nbsp;
<A HREF="http://www.openwall.com/lists/passwdqc-users/">passwdqc-users</A>&nbsp;
<A HREF="http://www.openwall.com/lists/yescrypt/">yescrypt</A>&nbsp;
<A HREF="http://www.openwall.com/lists/popa3d-users/">popa3d-users</A>&nbsp;
/&nbsp;
<A HREF="http://www.openwall.com/lists/oss-security/">oss-security</A>&nbsp;
<A HREF="http://www.openwall.com/lists/kernel-hardening/">kernel-hardening</A>&nbsp;
<A HREF="http://www.openwall.com/lists/musl/">musl</A>&nbsp;
<A HREF="http://www.openwall.com/lists/sabotage/">sabotage</A>&nbsp;
<A HREF="http://www.openwall.com/lists/tlsify/">tlsify</A>&nbsp;
<A HREF="http://www.openwall.com/lists/passwords/">passwords</A>&nbsp;
/&nbsp;
<A HREF="http://www.openwall.com/lists/crypt-dev/">crypt-dev</A>&nbsp;
<A HREF="http://www.openwall.com/lists/xvendor/">xvendor</A>&nbsp;
/&nbsp;
<A HREF="/bugtraq/">Bugtraq</A>&nbsp;
<A HREF="/full-disclosure/">Full-Disclosure</A>&nbsp;
<A HREF="/linux-kernel/">linux-kernel</A>&nbsp;
linux-<A HREF="/netdev/">netdev</A>&nbsp;
<A HREF="/linux-ext4/">linux-ext4</A>&nbsp;
<a href="/linux-hardening/">linux-hardening</a>&nbsp;
<a href="/linux-cve-announce/">linux-cve-announce</a>&nbsp;
<a href="/phc-discussions/">PHC</a>&nbsp;
<TR><TD>
<DIV><FONT SIZE="-2"><I>Open Source and information security mailing list archives</I></FONT></DIV>
<TR><TD>&nbsp;
</TABLE>

<TABLE bgcolor="#B4D0DC" width="100%" border="0" cellspacing="0" cellpadding="1">
<TR><TD>
<TABLE width="100%" border="0" cellspacing="0" cellpadding="2">
<TR><TD bgcolor="#ECF8FF">

<a href="https://hashsuite.openwall.net/android">
Hash Suite for Android: free password hash cracker in your pocket</a>


</TABLE>
</TABLE>


<a href="12">[&lt;prev]</a> <a href="14">[next&gt;]</a> <a href="7">[&lt;thread-prev]</a> <a href="14">[thread-next&gt;]</a> <a href=".">[day]</a> <a href="..">[month]</a> <a href="../..">[year]</a> <a href="../../..">[list]</a>
<pre style="white-space: pre-wrap">
Message-ID: &lt;CAJm83bB-9f0NwcP=PAEjG+WjUOxZCGMV3dK1+=c9hZRv0yODQg&#64;mail.gmail.com&gt;
Date: Fri, 4 Apr 2014 18:01:12 -0400
From: Daniel Franke &lt;dfoxfranke&#64;...il.com&gt;
To: discussions&#64;...sword-hashing.net
Subject: Re: [PHC] Re: EARWORM review

On 4/4/14, Bill Cox &lt;waywardgeek&#64;...il.com&gt; wrote:
&gt; In this case, each ASIC would split up it's portion of the ROM into
&gt; 4096 1MiB "chunk areas" in external DRAM.  It would also store up to
&gt; 4GiB/64 = 64Mi password scratchpads, each representing a password
&gt; guess in progress.  As it loads it's 4096 chunk areas sequentially,
&gt; over and over, it computes all the workunit updates with as much
&gt; parallelism as the ASIC can support, maybe 100-ish or even 1000-ish
&gt; AESENC cores, pipelined maybe 6 deep.  That would be 600-ish to
&gt; 6000-ish AESENC executed in parallel per ASIC, or around 150K to 1.5M
&gt; in total, applying AES-128 hashing to all of it's 512-bit scratchpads
&gt; that are waiting on that specific chunk area to be applied.

This attack seems to be exploiting the grid-aligned structure of
EARWORM's arena, in which chunks begin at discrete 1MiB boundaries.
There was another thread here in which Solar observed that to split
the arena into W=4 sections, and divide it across multiple machines,
each of which needs only the first section and one other.  I suggested
then that you could prevent this by collapsing the arena's three
dimensions into one and making possible for chunks to begin at any
point along that dimension.

So instead of

for l from 0 to L-1
    for w from 0 to W-1
        scratchpad[w] = AESRound(arena[index][l][w], scratchpad[w])
index = scratchpad[0] mod 2**m_cost

we'd have

for l from 0 to L-1
    for w from 0 to W-1
        scratchpad[w] = AESRound(arena[index++], scratchpad[w])
index = scratchpad[0] mod (2**mcost * L * W)

and add one extra chunk to the arena (for a size of (2**m_cost + 1) *
L * W blocks) so that this doesn't overflow.

I didn't make this change because I didn't view Solar's attack as a
threat within my model. This one, however, is a horse of a different
color. It seems that the same change would make your attack much more
expensive, because if you can't partition the ROM into discrete chunk
areas, then the routing complexity increases enormously. Do I have that
correct?

&gt; One reasonable defense against this attack would be to do memory-hard
&gt; writes as well as reads, to maybe a few MiB per password hash.  This
&gt; would cause my evil machine to need maybe 1000X more memory than I
&gt; described, memory bandwidth would likely become the bottleneck, and
&gt; the hypercube communication network might get overloaded.

This would be a much more substantial change. The resulting design
would look more like yescrypt than like the current version of
EARWORM. I'm not going to go there, and I wouldn't expect the panel to
let me get away with it if I tried.
</pre>
<p><a href="https://www.openwall.com/blists/">Powered by blists</a> - <a href="https://lists.openwall.net">more mailing lists</a>


<p>




</body>
</html>
