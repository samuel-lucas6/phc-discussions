<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style type="text/css">
body { font-size: 16px; }
.cal_brief { text-align: center; }
.cal_brief td:first-child { background: inherit; }
.cal_brief td { background: #ccc; width: 5ex; padding: 2px; }
.cal_big { text-align: center; padding: 0; margin: 0; }
.cal_big td { padding: 0 2px; }
.cal_mon { text-align: center; }
.cal_mon th { font-size: small; padding: 0; margin: 0; }
.cal_mon td { background: #ccc; width: 5ex; height: 1.5em;
	padding: 2px; text-align: right; }
.cal_mon td[colspan] { background: inherit; }
.cal_mon sup { color: #F0F0F0; text-align: left; float: left;
	margin-top: -2pt; font-weight: bold; }
.cal_mon a { text-align: right; margin-left: -4em; float: right; }
</style>

<title>phc-discussions - Re: Re: Re: Second factor (was A review per day - Schvrch)</title>


</head>

<BODY bgcolor="#E0E0E0" text="black" link="blue" alink="red" vlink="navy">



<TABLE bgcolor="white" width="100%" border="0" cellspacing="0" cellpadding="0">
<TR>
<TD width="39%">
<A HREF="http://lists.openwall.net">lists.openwall.net</A>
<TD width="1%" rowspan="3">&nbsp;
<TD width="60%" align="right" rowspan="3">
<A HREF="/">lists</A>&nbsp;
/&nbsp;
<A HREF="http://www.openwall.com/lists/announce/">announce</A>&nbsp;
<A HREF="http://www.openwall.com/lists/owl-users/">owl-users</A>&nbsp;
<A HREF="http://www.openwall.com/lists/owl-dev/">owl-dev</A>&nbsp;
<A HREF="http://www.openwall.com/lists/john-users/">john-users</A>&nbsp;
<A HREF="http://www.openwall.com/lists/john-dev/">john-dev</A>&nbsp;
<A HREF="http://www.openwall.com/lists/passwdqc-users/">passwdqc-users</A>&nbsp;
<A HREF="http://www.openwall.com/lists/yescrypt/">yescrypt</A>&nbsp;
<A HREF="http://www.openwall.com/lists/popa3d-users/">popa3d-users</A>&nbsp;
/&nbsp;
<A HREF="http://www.openwall.com/lists/oss-security/">oss-security</A>&nbsp;
<A HREF="http://www.openwall.com/lists/kernel-hardening/">kernel-hardening</A>&nbsp;
<A HREF="http://www.openwall.com/lists/musl/">musl</A>&nbsp;
<A HREF="http://www.openwall.com/lists/sabotage/">sabotage</A>&nbsp;
<A HREF="http://www.openwall.com/lists/tlsify/">tlsify</A>&nbsp;
<A HREF="http://www.openwall.com/lists/passwords/">passwords</A>&nbsp;
/&nbsp;
<A HREF="http://www.openwall.com/lists/crypt-dev/">crypt-dev</A>&nbsp;
<A HREF="http://www.openwall.com/lists/xvendor/">xvendor</A>&nbsp;
/&nbsp;
<A HREF="/bugtraq/">Bugtraq</A>&nbsp;
<A HREF="/full-disclosure/">Full-Disclosure</A>&nbsp;
<A HREF="/linux-kernel/">linux-kernel</A>&nbsp;
linux-<A HREF="/netdev/">netdev</A>&nbsp;
<A HREF="/linux-ext4/">linux-ext4</A>&nbsp;
<a href="/linux-hardening/">linux-hardening</a>&nbsp;
<a href="/linux-cve-announce/">linux-cve-announce</a>&nbsp;
<a href="/phc-discussions/">PHC</a>&nbsp;
<TR><TD>
<DIV><FONT SIZE="-2"><I>Open Source and information security mailing list archives</I></FONT></DIV>
<TR><TD>&nbsp;
</TABLE>

<TABLE bgcolor="#B4D0DC" width="100%" border="0" cellspacing="0" cellpadding="1">
<TR><TD>
<TABLE width="100%" border="0" cellspacing="0" cellpadding="2">
<TR><TD bgcolor="#ECF8FF">

<a href="https://hashsuite.openwall.net/android">
Hash Suite for Android: free password hash cracker in your pocket</a>


</TABLE>
</TABLE>


<a href="27">[&lt;prev]</a> <a href="29">[next&gt;]</a> <a href="27">[&lt;thread-prev]</a> <a href="29">[thread-next&gt;]</a> <a href=".">[day]</a> <a href="..">[month]</a> <a href="../..">[year]</a> <a href="../../..">[list]</a>
<pre style="white-space: pre-wrap">
Message-ID: &lt;lu84p6$gdl$1&#64;ger.gmane.org&gt;
Date: Wed, 03 Sep 2014 15:29:56 -0700
From: Alex Elsayed &lt;eternaleye&#64;...il.com&gt;
To: discussions&#64;...sword-hashing.net
Subject: Re: Re: Re: Second factor (was A review per day - Schvrch)

Andy Lutomirski wrote:

&gt; On Wed, Sep 3, 2014 at 2:32 PM, Alex Elsayed
&gt; &lt;eternaleye&#64;...il.com&gt; wrote:
&gt;&gt; Andy Lutomirski wrote:
&gt;&gt;
&gt;&gt;&gt; On Wed, Sep 3, 2014 at 12:31 PM, Alex Elsayed
&gt;&gt; However, here's another try:
&gt;&gt;
&gt;&gt; The user 'U' holds a PIN 'N' and a password 'P'
&gt;&gt; the token 'T' holds a secret value 'X'
&gt;&gt;
&gt;&gt; 1.) T and U execute a PAKE over N, yielding channel C_t
&gt;&gt; 2.) U sends P over C_t
&gt;&gt; 3.) T combines X and P, yielding Y
&gt;&gt; 4.) A and T execute a PAKE over Y, yielding channel C_a (U relays
&gt;&gt; messages) 5.) T sends its derived key for C_a over C_t
&gt;&gt; 6.) U and A are now authenticated (or not, but 'not' leaks no
&gt;&gt; information)
&gt;&gt;
&gt;&gt; I suspect the method used to combine X and P is pretty much irrelevant,
&gt;&gt; since Y never leaves the token, meaning that the token can get away with
&gt;&gt; being nothing more than a PAKE implementation and a tiny amount of
&gt;&gt; storage.
&gt;&gt;
&gt;&gt; To recap your requirements:
&gt;&gt;&gt; a) Use of the token is protected by a passphrase.
&gt;&gt;
&gt;&gt; Yep - without the PIN, the initial secured channel cannot be established.
&gt;&gt;
&gt;&gt;&gt; b) The token can't tell whether a given passphrase is correct or not.
&gt;&gt;
&gt;&gt; Yep - it simply composes the user secret and its own secret.
&gt;&gt;
&gt;&gt;&gt; c) If the token is honest, then no one can test a candidate passphrase
&gt;&gt;&gt; without querying the token once per passphrase tested.
&gt;&gt;
&gt;&gt; Yep - because the token executes the PAKE protocol with the auth server,
&gt;&gt; it can't be cut out of the loop.
&gt;&gt;
&gt;&gt;&gt; d) If the token is stolen but the computer it's in remains
&gt;&gt;&gt; uncompromised, then the token is completely useless to an attacker.
&gt;&gt;
&gt;&gt; Yep - because of the properties of a secure PAKE, nothing that could be
&gt;&gt; used to recover X ever leaves the token, and P was never present.
&gt;&gt;
&gt; 
&gt; Nice.  I think I agree, as long as P actually something derived from
&gt; the passphrase and something stored on the user's computer as opposed
&gt; to being an actual passphrase.

I disagree - processing the passphrase before handing it to the token gives 
no additional security, AFAICT, because whatever you give to it is 
sufficient to authenticate as you. If someone snoops the processed whatever, 
the security failure is exactly the same as snooping your passphrase when no 
processing is done.

As a simplified case, imagine a server that stores H(P), and you send P in 
plaintext. Clearly, Eve can just snarf P off the wire, and authenticate as 
you.

But the server storing H(H(P)) and you sending H(P) doesn't prevent that in 
any way; it just means Eve now snarfs H(P) and authenticates as you.

Besides, why store _anything_ on the user's computer? The user types in N, 
and then P, and neither has any related data stored anywhere on the 
computer; the less you process P the less time it spends resident in memory 
as well. Treat it like a hot potato and hand it straight to the token.

This also avoids "my hard drive died" failures.

&gt; Maybe I should try to implement something like this for OpenSSH :)  If
&gt; only the world could agree on a simple, fast patent-free augmented
&gt; PAKE with a good security proof.  I think that some of the
&gt; EKE/Elligator stuff works nicely as a balanced PAKE.  I guess the IPR
&gt; situation for AugPAKE as specified in RFC6628 might be workable.

SRP is clean AIUI - there was some FUD, but the relevant EKE patents a.) 
were explicitly avoided according to the SRP folks, b.) were never litigated 
and c.) expired in 2011/2013

Or at least that's what I recall.

Plus, OpenSSL already supports it.

</pre>
<p><a href="https://www.openwall.com/blists/">Powered by blists</a> - <a href="https://lists.openwall.net">more mailing lists</a>


<p>




</body>
</html>
