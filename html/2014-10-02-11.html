<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style type="text/css">
body { font-size: 16px; }
.cal_brief { text-align: center; }
.cal_brief td:first-child { background: inherit; }
.cal_brief td { background: #ccc; width: 5ex; padding: 2px; }
.cal_big { text-align: center; padding: 0; margin: 0; }
.cal_big td { padding: 0 2px; }
.cal_mon { text-align: center; }
.cal_mon th { font-size: small; padding: 0; margin: 0; }
.cal_mon td { background: #ccc; width: 5ex; height: 1.5em;
	padding: 2px; text-align: right; }
.cal_mon td[colspan] { background: inherit; }
.cal_mon sup { color: #F0F0F0; text-align: left; float: left;
	margin-top: -2pt; font-weight: bold; }
.cal_mon a { text-align: right; margin-left: -4em; float: right; }
</style>

<title>phc-discussions - Re: [PHC] Design Rationale and Security Analysis of PHC candidates</title>


</head>

<BODY bgcolor="#E0E0E0" text="black" link="blue" alink="red" vlink="navy">



<TABLE bgcolor="white" width="100%" border="0" cellspacing="0" cellpadding="0">
<TR>
<TD width="39%">
<A HREF="http://lists.openwall.net">lists.openwall.net</A>
<TD width="1%" rowspan="3">&nbsp;
<TD width="60%" align="right" rowspan="3">
<A HREF="/">lists</A>&nbsp;
/&nbsp;
<A HREF="http://www.openwall.com/lists/announce/">announce</A>&nbsp;
<A HREF="http://www.openwall.com/lists/owl-users/">owl-users</A>&nbsp;
<A HREF="http://www.openwall.com/lists/owl-dev/">owl-dev</A>&nbsp;
<A HREF="http://www.openwall.com/lists/john-users/">john-users</A>&nbsp;
<A HREF="http://www.openwall.com/lists/john-dev/">john-dev</A>&nbsp;
<A HREF="http://www.openwall.com/lists/passwdqc-users/">passwdqc-users</A>&nbsp;
<A HREF="http://www.openwall.com/lists/yescrypt/">yescrypt</A>&nbsp;
<A HREF="http://www.openwall.com/lists/popa3d-users/">popa3d-users</A>&nbsp;
/&nbsp;
<A HREF="http://www.openwall.com/lists/oss-security/">oss-security</A>&nbsp;
<A HREF="http://www.openwall.com/lists/kernel-hardening/">kernel-hardening</A>&nbsp;
<A HREF="http://www.openwall.com/lists/musl/">musl</A>&nbsp;
<A HREF="http://www.openwall.com/lists/sabotage/">sabotage</A>&nbsp;
<A HREF="http://www.openwall.com/lists/tlsify/">tlsify</A>&nbsp;
<A HREF="http://www.openwall.com/lists/passwords/">passwords</A>&nbsp;
/&nbsp;
<A HREF="http://www.openwall.com/lists/crypt-dev/">crypt-dev</A>&nbsp;
<A HREF="http://www.openwall.com/lists/xvendor/">xvendor</A>&nbsp;
/&nbsp;
<A HREF="/bugtraq/">Bugtraq</A>&nbsp;
<A HREF="/full-disclosure/">Full-Disclosure</A>&nbsp;
<A HREF="/linux-kernel/">linux-kernel</A>&nbsp;
linux-<A HREF="/netdev/">netdev</A>&nbsp;
<A HREF="/linux-ext4/">linux-ext4</A>&nbsp;
<a href="/linux-hardening/">linux-hardening</a>&nbsp;
<a href="/linux-cve-announce/">linux-cve-announce</a>&nbsp;
<a href="/phc-discussions/">PHC</a>&nbsp;
<TR><TD>
<DIV><FONT SIZE="-2"><I>Open Source and information security mailing list archives</I></FONT></DIV>
<TR><TD>&nbsp;
</TABLE>

<TABLE bgcolor="#B4D0DC" width="100%" border="0" cellspacing="0" cellpadding="1">
<TR><TD>
<TABLE width="100%" border="0" cellspacing="0" cellpadding="2">
<TR><TD bgcolor="#ECF8FF">

<a href="https://hashsuite.openwall.net/android">
Hash Suite for Android: free password hash cracker in your pocket</a>


</TABLE>
</TABLE>


<a href="10">[&lt;prev]</a> <a href="12">[next&gt;]</a> <a href="10">[&lt;thread-prev]</a> <a href="12">[thread-next&gt;]</a> <a href=".">[day]</a> <a href="..">[month]</a> <a href="../..">[year]</a> <a href="../../..">[list]</a>
<pre style="white-space: pre-wrap">
Message-ID: &lt;CALW8-7Lxr8KaN2WeSLycG-NyeFuy=1iX3RC5sUX6hYNQD1LjXQ&#64;mail.gmail.com&gt;
Date: Thu, 2 Oct 2014 14:23:07 +0200
From: Dmitry Khovratovich &lt;khovratovich&#64;...il.com&gt;
To: "discussions&#64;...sword-hashing.net" &lt;discussions&#64;...sword-hashing.net&gt;
Subject: Re: [PHC] Design Rationale and Security Analysis of PHC candidates

Thank you, Thomas,

This is a good example of a reductionist proof. I am ready to update the
table if you put this into a separate note. The issue with Rabin padding is
particularly relevant and deserves such a document.

Dmitry

On Thu, Oct 2, 2014 at 2:02 PM, Thomas Pornin &lt;pornin&#64;...et.org&gt; wrote:

&gt; On Thu, Oct 02, 2014 at 12:50:31PM +0200, Dmitry Khovratovich wrote:
&gt; &gt; The value "Explored" stands for the case when the designers actually try
&gt; to
&gt; &gt; mount a collision/preimage attack on their design and show why it fails.
&gt; It
&gt; &gt; is not the best possible option: ideally, one would provide some sort of
&gt; &gt; security proof that reduces the security of the mode of operation (which
&gt; &gt; the hashing scheme is) to the security of the underlying primitive, and
&gt; &gt; thus get the grade "Verified" or "Proven".
&gt;
&gt; In that case, I'll claim that "proven" status for Makwa.
&gt;
&gt; Without pre-hashing or post-hashing:
&gt;
&gt;   The Makwa core really is Rabin encryption, followed by many squarings.
&gt;   Since the Rabin encryption output is a quadratic residue, and squaring
&gt;   is a permutation of quadratic residues (when working modulo a Blum
&gt;   integer), then it follows that any preimage attack against Makwa is
&gt;   also a preimage attack against Rabin encryption (see note 2 below).
&gt;   Rabin encryption is the "underlying primitive", still unbroken after
&gt;   more than three decades of exposure in the field.
&gt;
&gt;   As for collisions: since the squarings are a permutation, only the
&gt;   very first squaring may induce a collision. However, if there is a
&gt;   collision, then you get two values x and y such that x^2 = y^2 modulo
&gt;   N. Moreover, since the most significant bit of both values are zero,
&gt;   it cannot be that x = -y. Then it follows that gcd(x+y,N) reveals a
&gt;   non-trivial factor of N. Thus, finding a collision for Makwa (without
&gt;   post-hashing) implies factoring N, which is known to be hard.
&gt;
&gt;   Note that the arguments above don't rely on any property of the salt.
&gt;   It could be entirely under attacker's control; it would not change
&gt;   anything here.
&gt;
&gt; With pre-hashing or post-hashing:
&gt;
&gt;   Makwa is a sequence of three elements: the pre-hash, the squarings,
&gt;   and the post-hash. When considering a combination of successive
&gt;   functions, it is rather obvious that:
&gt;    - any preimage attack on the combination implies a preimage attack
&gt;      on the last step;
&gt;    - any collision attack on the combination implies a collision
&gt;      atack on at least one of the steps.
&gt;   We saw above that the middle step of Makwa (the squarings) is
&gt;   resistant to both preimages and collisions (regardless of the
&gt;   attacker's control on the salt). Thus, Makwa, in all generality, is
&gt;   resistant to both preimages and collisions as long as the "hash
&gt;   function" used for the pre-hashing and post-hashing step is also
&gt;   resistant to collisions (note that the salt is not used for
&gt;   pre-hashing and post-hashing).
&gt;
&gt;   However, that hash function is HMAC_DRBG, a well-known primitive which
&gt;   has been proven to be "perfect" (indistinguishable from a random
&gt;   oracle) as long as the underlying HMAC lives up to its promises (the
&gt;   references are in the Makwa spec).
&gt;
&gt; One design principle of Makwa was to rely on existing, "proven"
&gt; primitives (at least proven through years of exposure, though any kind
&gt; of reduction proof is also nice to have).
&gt;
&gt;
&gt;
&gt; Note 1: you can still botch things by using post-hashing to get a
&gt; deliberately short output; e.g. with 80 bits of output, resistance to
&gt; preimages cannot exceed 2^80, and 2^40 for collisions. But mind the
&gt; details:
&gt;
&gt;  - This "2^80" is counted in a number of evaluations of the underlying
&gt;    function, which is designed to be slow. That does not translate to
&gt;    the usual "2^80 simple operations" or "2^80 invocations of MD5".
&gt;
&gt;  - If an attacker is allowed to run 2^80 operations, then he can guess
&gt;    the password, because we are hashing passwords, and it would not be
&gt;    wise to claim that passwords offer 80 bits of entropy.
&gt;
&gt;  - Collisions are an issue for password hashing only in the context of
&gt;    rather esoteric scenarios involving some underspecified extra bug. I
&gt;    never found that convincing in any way; for me, resistance to
&gt;    collisions is irrelevant to password hashing. However, if you worry
&gt;    about collisions, then you can just ask for a twice longer output:
&gt;    HMAC_DRBG can produce as many bytes as you wish.
&gt;
&gt;  - This point about output length is completely generic: it applies to
&gt;    _all_ password hashing functions.
&gt;
&gt;
&gt; Note 2: there is still one delicate point about Rabin encryption.
&gt; Contrary to RSA, it was never specified with a RFC or a similar
&gt; standard. In particular, the "padding" step was not specified. It is
&gt; also known that while extracting square roots modulo N is _in general_
&gt; equivalent to factoring N, square root extraction for some values can be
&gt; easy: namely if x^2 &lt; N (as integers), then the square root of x^2
&gt; modulo N is also the square root of the natural integer x^2, i.e. x.
&gt; This is a well-known property which also applies to RSA (with cubic
&gt; roots for RSA with e=3). This is the reason why the PKCS#1 padding,
&gt; defined for RSA, ensures that there are some non-zero bits in the most
&gt; significant positions. The padding used in Makwa is very similar to the
&gt; PKCS#1 padding, for pretty much the same reasons. In that sense, Makwa
&gt; is as strong as Rabin encryption would be, if Rabin encryption was
&gt; specified with PKCS#1 padding.
&gt;
&gt; To be more formal, I _define_ Rabin encryption to consist in the following:
&gt;
&gt;  - Pad input message m to a sequence x of the same length of N:
&gt;
&gt;     x = 0x00 || rrrrrr || m || len(m)
&gt;
&gt;    where len(m) is the length of m in bytes (expressed over a single byte),
&gt;    and "rrrrrr" is a sequence of random bytes of suitable length (so that
&gt;    the length of x equals that of N). There are at least 30 random bytes.
&gt;
&gt;  - The encrypted message is x^2 mod N (x is interpreted as an integer with
&gt;    the big-endian convention).
&gt;
&gt; I claim that this instanciation of Rabin encryption is a faithful
&gt; practical incarnation of "the" Rabin encryption scheme which has been
&gt; studied at length by cryptographers. This is my underlying primitive.
&gt;
&gt; Makwa replaces the "random rrrrrr" with the deterministically generated
&gt; bytes produced by HMAC_DRBG, but this is equivalent (from an attacker's
&gt; point of view) because HMAC_DRBG is indistinguishable from a random
&gt; oracle (see above).
&gt;
&gt;
&gt; (I agree that this analysis is not well explained in the Makwa
&gt; specification.)
&gt;
&gt;
&gt;         --Thomas Pornin
&gt;



-- 
Best regards,
Dmitry Khovratovich

<span style="font-family: times;"><strong>Content of type "</strong>text/html<strong>" skipped</strong></span>
</pre>
<p><a href="https://www.openwall.com/blists/">Powered by blists</a> - <a href="https://lists.openwall.net">more mailing lists</a>


<p>




</body>
</html>
