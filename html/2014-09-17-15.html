<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style type="text/css">
body { font-size: 16px; }
.cal_brief { text-align: center; }
.cal_brief td:first-child { background: inherit; }
.cal_brief td { background: #ccc; width: 5ex; padding: 2px; }
.cal_big { text-align: center; padding: 0; margin: 0; }
.cal_big td { padding: 0 2px; }
.cal_mon { text-align: center; }
.cal_mon th { font-size: small; padding: 0; margin: 0; }
.cal_mon td { background: #ccc; width: 5ex; height: 1.5em;
	padding: 2px; text-align: right; }
.cal_mon td[colspan] { background: inherit; }
.cal_mon sup { color: #F0F0F0; text-align: left; float: left;
	margin-top: -2pt; font-weight: bold; }
.cal_mon a { text-align: right; margin-left: -4em; float: right; }
</style>

<title>phc-discussions - Re: [PHC] omegacrypt and timing</title>


</head>

<BODY bgcolor="#E0E0E0" text="black" link="blue" alink="red" vlink="navy">



<TABLE bgcolor="white" width="100%" border="0" cellspacing="0" cellpadding="0">
<TR>
<TD width="39%">
<A HREF="http://lists.openwall.net">lists.openwall.net</A>
<TD width="1%" rowspan="3">&nbsp;
<TD width="60%" align="right" rowspan="3">
<A HREF="/">lists</A>&nbsp;
/&nbsp;
<A HREF="http://www.openwall.com/lists/announce/">announce</A>&nbsp;
<A HREF="http://www.openwall.com/lists/owl-users/">owl-users</A>&nbsp;
<A HREF="http://www.openwall.com/lists/owl-dev/">owl-dev</A>&nbsp;
<A HREF="http://www.openwall.com/lists/john-users/">john-users</A>&nbsp;
<A HREF="http://www.openwall.com/lists/john-dev/">john-dev</A>&nbsp;
<A HREF="http://www.openwall.com/lists/passwdqc-users/">passwdqc-users</A>&nbsp;
<A HREF="http://www.openwall.com/lists/yescrypt/">yescrypt</A>&nbsp;
<A HREF="http://www.openwall.com/lists/popa3d-users/">popa3d-users</A>&nbsp;
/&nbsp;
<A HREF="http://www.openwall.com/lists/oss-security/">oss-security</A>&nbsp;
<A HREF="http://www.openwall.com/lists/kernel-hardening/">kernel-hardening</A>&nbsp;
<A HREF="http://www.openwall.com/lists/musl/">musl</A>&nbsp;
<A HREF="http://www.openwall.com/lists/sabotage/">sabotage</A>&nbsp;
<A HREF="http://www.openwall.com/lists/tlsify/">tlsify</A>&nbsp;
<A HREF="http://www.openwall.com/lists/passwords/">passwords</A>&nbsp;
/&nbsp;
<A HREF="http://www.openwall.com/lists/crypt-dev/">crypt-dev</A>&nbsp;
<A HREF="http://www.openwall.com/lists/xvendor/">xvendor</A>&nbsp;
/&nbsp;
<A HREF="/bugtraq/">Bugtraq</A>&nbsp;
<A HREF="/full-disclosure/">Full-Disclosure</A>&nbsp;
<A HREF="/linux-kernel/">linux-kernel</A>&nbsp;
linux-<A HREF="/netdev/">netdev</A>&nbsp;
<A HREF="/linux-ext4/">linux-ext4</A>&nbsp;
<a href="/linux-hardening/">linux-hardening</a>&nbsp;
<a href="/linux-cve-announce/">linux-cve-announce</a>&nbsp;
<a href="/phc-discussions/">PHC</a>&nbsp;
<TR><TD>
<DIV><FONT SIZE="-2"><I>Open Source and information security mailing list archives</I></FONT></DIV>
<TR><TD>&nbsp;
</TABLE>

<TABLE bgcolor="#B4D0DC" width="100%" border="0" cellspacing="0" cellpadding="1">
<TR><TD>
<TABLE width="100%" border="0" cellspacing="0" cellpadding="2">
<TR><TD bgcolor="#ECF8FF">

<a href="https://hashsuite.openwall.net/android">
Hash Suite for Android: free password hash cracker in your pocket</a>


</TABLE>
</TABLE>


<a href="14">[&lt;prev]</a> <a href="16">[next&gt;]</a> <a href="14">[&lt;thread-prev]</a> <a href="16">[thread-next&gt;]</a> <a href=".">[day]</a> <a href="..">[month]</a> <a href="../..">[year]</a> <a href="../../..">[list]</a>
<pre style="white-space: pre-wrap">
Message-ID: &lt;361056288.465690.1410974097650.open-xchange&#64;oxuslxltgw10.lxa.perfora.net&gt;
Date: Wed, 17 Sep 2014 12:14:57 -0500 (CDT)
From: Steve Thomas &lt;steve&#64;...tu.com&gt;
To: discussions&#64;...sword-hashing.net
Subject: Re: [PHC] omegacrypt and timing

&gt; On September 17, 2014 at 11:14 AM Brandon Enright
&gt; &lt;bmenrigh&#64;...ndonenright.net&gt; wrote:
&gt;
&gt; On Wed, 17 Sep 2014 06:30:36 -0400
&gt; Bill Cox &lt;waywardgeek&#64;...hershed.org&gt; wrote:
&gt;
&gt; &gt; I think OmegaCrypt, POMELO,
&gt; &gt; and Schvrch do too little data-based branching to badly hurt a GPU
&gt; &gt; attack. The GPU can simply execute each case serially, and only write
&gt; &gt; data for the selected case, so with N cases, a GPU will not slow down
&gt; &gt; by more than a factor of N.
&gt;
&gt; This attack doesn't work against OmegaCrypt. Each branch consumes a
&gt; different amount of the ChaCha stream used to guide future branching.
&gt; Also, there is a carry value from the previous round.
&gt;

That's is the exact reason this is easier to attack than the other algorithms.
Each branch using different amounts of ChaCha stream means run-times of
different passwords are going to have a larger run time deviations. Thus if you
know exactly how long it takes to run then without the hash you can run tests
narrowing the number of online password guesses. This assumes you can get
several timings of a valid login and the salt (either by obtaining it but not
the hash [ie encrypted hash] or the timing of several password attempts leaks
the salt). I consider this attack minuscule compared to random memory access.
Since I think that side channel is easier.


&gt; For the very first round of branching the GPU could run all 4 in
&gt; parallel and select the correct one. But, for the second round, the
&gt; GPU would have to run branch 1 for each of the possible previous
&gt; branches, and branch 2 for each of the possible branches, and so
&gt; forth.
&gt;
&gt; The carry value is modified from start to finish through each
&gt; branch. There is no realistic way to perform the attack you describe
&gt; because the previous branch path possibilities grows exponentially.
&gt; After just a few rounds you'd be doing an exponential amount of work.
&gt;

When you run out of the ChaCha block data you conditionally generate another.
There is no exponential cost increase for GPUs.


&gt; Or perhaps you're imagining doing all 4 branches, then pausing to
&gt; figure out which was right, then doing another 4, pausing to figure out
&gt; which was right, and so on? You'd need some sort of copy-on-write
&gt; memory to facilitate "backing out" of the changes made by wrong
&gt; branches. I don't see how you'd actually be avoiding any
&gt; data-dependant branching.
&gt;
&gt; Can you explain more concretely what your suggested attack is? I don't
&gt; see how what you're describing would actually work.
&gt;
&gt; Also for what it's worth, if OmegaCrypt makes it to round 2 I plan on
&gt; adjusting the branches to consume a coprime amount of the ChaCha stream
&gt; to further protect against executing future rounds by trying all the
&gt; combinations of the previous rounds.
&gt;

With GPUs they have a conditional variable that determines whether an
instruction is run or not. x86 SIMD does not have this, yet. It's coming to
AVX-512.
</pre>
<p><a href="https://www.openwall.com/blists/">Powered by blists</a> - <a href="https://lists.openwall.net">more mailing lists</a>


<p>




</body>
</html>
